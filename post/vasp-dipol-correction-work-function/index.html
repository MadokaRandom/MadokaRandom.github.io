<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>VASP 偶极校正及功函数的计算 - Ionizing Radiation</title>
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes">
<meta name=MobileOptimized content="width">
<meta name=HandheldFriendly content="true">
<meta name=applicable-device content="pc,mobile">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=mobile-web-app-capable content="yes">
<meta name=author content="Ionizing">
<meta name=description content=" 概念解释  功函数 真空能级 偶极校正   如何计算  偶极校正 功函数   真空能级  水文一篇，介绍了如何用 VASP 添加偶极校正参数、计算 Slab 体系的功函数，以及如何找真空能级。
">
<meta name=keywords content="PhysicalChemistry,ComputerScience">
<meta name=generator content="Hugo 0.87.0">
<link rel=canonical href=http://ionizing.page/post/vasp-dipol-correction-work-function/>
<link rel=icon href=/favicon.ico>
<link rel=stylesheet href=/sass/jane.min.fa4b2b9f31b5c6d0b683db81157a9226e17b06e61911791ab547242a4a0556f2.css integrity="sha256-+ksrnzG1xtC2g9uBFXqSJuF7BuYZEXkatUckKkoFVvI=" media=screen crossorigin=anonymous>
<meta property="og:title" content="VASP 偶极校正及功函数的计算">
<meta property="og:description" content="


概念解释

功函数
真空能级
偶极校正


如何计算

偶极校正
功函数


真空能级


水文一篇，介绍了如何用 VASP 添加偶极校正参数、计算 Slab 体系的功函数，以及如何找真空能级。">
<meta property="og:type" content="article">
<meta property="og:url" content="http://ionizing.page/post/vasp-dipol-correction-work-function/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-04-23T16:44:00+08:00">
<meta property="article:modified_time" content="2021-04-23T16:44:00+08:00">
<meta itemprop=name content="VASP 偶极校正及功函数的计算">
<meta itemprop=description content="


概念解释

功函数
真空能级
偶极校正


如何计算

偶极校正
功函数


真空能级


水文一篇，介绍了如何用 VASP 添加偶极校正参数、计算 Slab 体系的功函数，以及如何找真空能级。"><meta itemprop=datePublished content="2021-04-23T16:44:00+08:00">
<meta itemprop=dateModified content="2021-04-23T16:44:00+08:00">
<meta itemprop=wordCount content="1566">
<meta itemprop=keywords content="Posts,VASP,Python,ASE,DipoleCorrection,Workfunction,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="VASP 偶极校正及功函数的计算">
<meta name=twitter:description content="


概念解释

功函数
真空能级
偶极校正


如何计算

偶极校正
功函数


真空能级


水文一篇，介绍了如何用 VASP 添加偶极校正参数、计算 Slab 体系的功函数，以及如何找真空能级。"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/ class=logo>IonizingRadiation</a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<li class=mobile-menu-item>
<a class=menu-item-link href=http://ionizing.page/>Home</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=http://ionizing.page/post/>Archives</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=http://ionizing.page/tags/>Tags</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=http://ionizing.page/categories/>Categories</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=http://ionizing.page/about/>About</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=http://ionizing.page/external-link/>External-link</a>
</li>
</ul>
</nav>
<link rel=stylesheet href=/lib/photoswipe/photoswipe.min.css>
<link rel=stylesheet href=/lib/photoswipe/default-skin/default-skin.min.css>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div>
<header id=header class="header container">
<div class=logo-wrapper>
<a href=/ class=logo>
IonizingRadiation
</a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=http://ionizing.page/>Home</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=http://ionizing.page/post/>Archives</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=http://ionizing.page/tags/>Tags</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=http://ionizing.page/categories/>Categories</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=http://ionizing.page/about/>About</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=http://ionizing.page/external-link/>External-link</a>
</li>
</ul>
</nav>
</header>
<div id=mobile-panel>
<main id=main class="main bg-llight">
<div class=content-wrapper>
<div id=content class="content container">
<article class="post bg-white">
<header class=post-header>
<h1 class=post-title>VASP 偶极校正及功函数的计算</h1>
<div class=post-meta>
<time datetime=2021-04-23 class=post-time>
2021-04-23
</time>
<div class=post-category>
<a href=http://ionizing.page/categories/physicalchemistry/> PhysicalChemistry </a>
</div>
</div>
</header>
<div class=post-toc id=post-toc>
<h2 class=post-toc-title>文章目录</h2>
<div class=post-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#概念解释>概念解释</a>
<ul>
<li><a href=#功函数>功函数</a></li>
<li><a href=#真空能级>真空能级</a></li>
<li><a href=#偶极校正>偶极校正</a></li>
</ul>
</li>
<li><a href=#如何计算>如何计算</a>
<ul>
<li><a href=#偶极校正>偶极校正</a></li>
<li><a href=#功函数>功函数</a></li>
</ul>
</li>
<li><a href=#真空能级>真空能级</a></li>
</ul>
</nav>
</div>
</div>
<div class=post-content>
<ul>
<li><a href=#%E6%A6%82%E5%BF%B5%E8%A7%A3%E9%87%8A>概念解释</a>
<ul>
<li><a href=#%E5%8A%9F%E5%87%BD%E6%95%B0>功函数</a></li>
<li><a href=#%E7%9C%9F%E7%A9%BA%E8%83%BD%E7%BA%A7>真空能级</a></li>
<li><a href=#%E5%81%B6%E6%9E%81%E6%A0%A1%E6%AD%A3>偶极校正</a></li>
</ul>
</li>
<li><a href=#%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97>如何计算</a>
<ul>
<li><a href=#%E5%81%B6%E6%9E%81%E6%A0%A1%E6%AD%A3>偶极校正</a></li>
<li><a href=#%E5%8A%9F%E5%87%BD%E6%95%B0>功函数</a></li>
</ul>
</li>
<li><a href=#%E7%9C%9F%E7%A9%BA%E8%83%BD%E7%BA%A7>真空能级</a></li>
</ul>
<p>水文一篇，介绍了如何用 VASP 添加偶极校正参数、计算 Slab 体系的功函数，以及如何找真空能级。</p>
<h2 id=概念解释>概念解释</h2>
<h3 id=功函数>功函数</h3>
<p>将一个固体内部的电子移动到真空所需的能量。（类似于光电效应方程中的逸出功）。</p>
<h3 id=真空能级>真空能级</h3>
<p>固体表面外真空中自由电子所具有的能量。换句话说，电子跑出固体表面并达到这个能级后即可认为它自由 <del>免费</del> 了。</p>
<h3 id=偶极校正>偶极校正</h3>
<p>因 VASP 所适用的体系是周期性体系，使用它来模拟实验中的 Slab 模型时会取一个相当大的真空层来隔绝相信两个周期中 Slab 的相互作用。理想情况下，真空层中的功函数应当是一条水平的直线（函数值为定值）。但如果表面的两侧并非对称，即其中一侧吸附了分子时，
这两侧的功函数存在差异，此时如果不进行偶极校正，真空中的功函数会是一条斜线；而经过偶极校正后，功函数会出现一个阶梯，阶梯两侧附近的曲接近水平。下图<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>是一个例子。</p>
<p></p>
<link rel=stylesheet href=/css/hugo-easy-gallery.css>
<div class=box>
<figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject>
<div class=img>
<img itemprop=thumbnail src=/ox-hugo/VCL-2.png alt="Figure 1: DFT 曲线为未经过偶极校正的功函数， DFT-DC 曲线是经过偶极校正后的功函数">
</div>
<a href=/ox-hugo/VCL-2.png itemprop=contentUrl></a>
<figcaption>
<p>Figure 1: DFT 曲线为未经过偶极校正的功函数， DFT-DC 曲线是经过偶极校正后的功函数</p>
</figcaption>
</figure>
</div>
<h2 id=如何计算>如何计算</h2>
<h3 id=偶极校正>偶极校正</h3>
<p>VASP 中直接使用 <code>LDIPOL</code> 和 <code>IDPOL</code> 即可开启它的偶极校正功能。</p>
<ul>
<li><code>LDIPOL = .TRUE.</code> 表示打开偶极校正；</li>
<li><code>IDIPOL = 3</code> 表示偶极校正所修正的方向为第 3 个晶格矢量方向对应的方向，一般来说就是 \(z\) 轴；</li>
<li><code>DIPOL = &lt;3 float values></code> 表示体系的中心，以分数坐标表示；</li>
</ul>
<p>上面几个 Flag 中一般来说 DIPOL 不用填，因为 VASP 手册中<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>有一句</p>
<blockquote>
<p>If the flag is not set, VASP determines, where the charge density averaged over
one plane drops to a minimum and calculates the center of the charge
distribution by adding half of the lattice vector perpendicular to the plane
where the charge density has a minimum (this is a rather reliable approach for
orthorhombic cells).</p>
</blockquote>
<p>不过有时不填它会导致体系 <strong>非常</strong> 难以收敛，如果遇到这各情况，最好还是手动算一下所有原子 \(z\) 坐标的平均值，然后 <code>DIPOL = 0.5 0.5 &lt;averaged z></code> ，此时修正效果可能并不好，读者需要：</p>
<ol>
<li>打开偶极校正和 <code>DIPOL = 0.5 0.5 &lt;averaged z></code> ，并弛豫结构到稳定；</li>
<li>关闭 <code>DIPOL</code> ，并弛豫到结构稳定；</li>
<li>关闭 <code>DIPOL</code> ，打开 <code>LVHAR = .TRUE.</code> ，并做静态计算，得到功函数；</li>
</ol>
<p>偶极校正的标准是功函数出现台阶，并且台阶两边为水平，如果画出的功函数图不是这样，
就要考虑调整参数了。</p>
<h3 id=功函数>功函数</h3>
<p>在 VASP 中 <code>LVHAR</code> <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>参数可以使 VASP 输出体系的功函数文件 <code>LOCPOT</code> 。LOCPOT
文件本身是 Volumetric data ，它的格式与 CHGCAR 一样<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>。一般而言，用户关心的功函数是垂直于表面方向上的数据，因此在得到 LOCPOT 后需要对它做一点工作，即对 \(xy\)
平面内的数据做平均，然后乘以晶胞的体积，就得到我们需要的功函数信息。这里给出一个脚本<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>来完成这项工作：</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>locpot_mean</span><span class=p>(</span><span class=n>fname</span><span class=o>=</span><span class=s2>&#34;LOCPOT&#34;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;z&#39;</span><span class=p>,</span> <span class=n>savefile</span><span class=o>=</span><span class=s1>&#39;locpot.dat&#39;</span><span class=p>,</span> <span class=n>outcar</span><span class=o>=</span><span class=s2>&#34;OUTCAR&#34;</span><span class=p>):</span>
    <span class=s1>&#39;&#39;&#39;
</span><span class=s1>    Reads the LOCPOT file and calculate the average potential along `axis`.
</span><span class=s1>     @in: See function argument.
</span><span class=s1>    @out:
</span><span class=s1>          - xvals: grid data along selected axis;
</span><span class=s1>          - mean: averaged potential corresponding to `xvals`.
</span><span class=s1>    &#39;&#39;&#39;</span>
    <span class=k>def</span> <span class=nf>get_efermi</span><span class=p>(</span><span class=n>outcar</span><span class=o>=</span><span class=s2>&#34;OUTCAR&#34;</span><span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>outcar</span><span class=p>):</span>
            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&#34;OUTCAR file not found. E-fermi set to 0.0eV&#34;</span><span class=p>)</span>
            <span class=k>return</span> <span class=kc>None</span>
        <span class=n>txt</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>outcar</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
        <span class=n>efermi</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;E-fermi :\s*([-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?)&#39;</span><span class=p>,</span> <span class=n>txt</span><span class=p>)</span><span class=o>.</span><span class=n>groups</span><span class=p>()[</span><span class=mi>0</span><span class=p>]</span>
        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Found E-fermi = </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>efermi</span><span class=p>))</span>
        <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>efermi</span><span class=p>)</span>

    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Loading LOCPOT file </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>fname</span><span class=p>))</span>
    <span class=n>locd</span> <span class=o>=</span> <span class=n>VaspChargeDensity</span><span class=p>(</span><span class=n>fname</span><span class=p>)</span>
    <span class=n>cell</span> <span class=o>=</span> <span class=n>locd</span><span class=o>.</span><span class=n>atoms</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>cell</span>
    <span class=n>latlens</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>cell</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>vol</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>det</span><span class=p>(</span><span class=n>cell</span><span class=p>)</span>

    <span class=n>iaxis</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>axis</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span>
    <span class=n>axes</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span>
    <span class=n>axes</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>iaxis</span><span class=p>)</span>
    <span class=n>axes</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>axes</span><span class=p>)</span>

    <span class=n>locpot</span> <span class=o>=</span> <span class=n>locd</span><span class=o>.</span><span class=n>chg</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
    <span class=c1># must multiply with cell volume, similar to CHGCAR</span>
    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Calculating workfunction along </span><span class=si>{}</span><span class=s2> axis&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>axis</span><span class=p>))</span>
    <span class=n>mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>locpot</span><span class=p>,</span> <span class=n>axes</span><span class=p>)</span> <span class=o>*</span> <span class=n>vol</span>

    <span class=n>xvals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>latlens</span><span class=p>[</span><span class=n>iaxis</span><span class=p>],</span> <span class=n>locpot</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=n>iaxis</span><span class=p>])</span>

    <span class=c1># save to &#39;locpot.dat&#39;</span>
    <span class=n>efermi</span> <span class=o>=</span> <span class=n>get_efermi</span><span class=p>(</span><span class=n>outcar</span><span class=p>)</span>
    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Saving raw data to </span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>savefile</span><span class=p>))</span>
    <span class=k>if</span> <span class=n>efermi</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>np</span><span class=o>.</span><span class=n>savetxt</span><span class=p>(</span><span class=n>savefile</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>c_</span><span class=p>[</span><span class=n>xvals</span><span class=p>,</span> <span class=n>mean</span><span class=p>],</span>
                   <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%13.5f</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>header</span><span class=o>=</span><span class=s1>&#39;Distance(A) Potential(eV) # E-fermi not corrected&#39;</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>mean</span> <span class=o>-=</span> <span class=n>efermi</span>
        <span class=n>np</span><span class=o>.</span><span class=n>savetxt</span><span class=p>(</span><span class=n>savefile</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>c_</span><span class=p>[</span><span class=n>xvals</span><span class=p>,</span> <span class=n>mean</span><span class=p>],</span>
                   <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%13.5f</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>header</span><span class=o>=</span><span class=s1>&#39;Distance(A) Potential(eV) # E-fermi shifted to 0.0eV&#39;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>完整的脚本文件已经放 Gist<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup> 上，当然你也可以直接点击<a href=vasp-dipol-correction-work-function/plot-workfunc.py>它</a>来下载。运行这个脚本后得到的 Workfunction.pdf 和 locpot.dat 就是 \(z\) 方向上的功函数信息。</p>
<p></p>
<div class=box>
<figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject>
<div class=img>
<img itemprop=thumbnail src=/ox-hugo/Workfunction.png alt="Figure 2: Workfunction.png 示例">
</div>
<a href=/ox-hugo/Workfunction.png itemprop=contentUrl></a>
<figcaption>
<p>Figure 2: Workfunction.png 示例</p>
</figcaption>
</figure>
</div>
<h2 id=真空能级>真空能级</h2>
<p>前面已经提到，真空能级可以读取 locpot.dat 真空部分的数据得到，其实当你打开
<code>LVHAR</code> 时，它也可以通过读取 OUTCAR 得到，比如</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-sh data-lang=sh>$ grep vacuum OUTCAR
 vacuum level on the upper side and lower side of the slab         2.807         3.188
</code></pre></td></tr></table>
</div>
</div><p>这里的 upper side vacuum level 是指 Slab 上表面的真空能级（图 <a href=#org755ef8c>2</a>
中 30A 处的平台）， lower side vacuum level 自然就是下表面的真空能级了
（图 <a href=#org755ef8c>2</a> 中 35A 处的平台）。</p>
<p>需要注意的是，从 OUTCAR 中 grep 出的真空能级没有经过费米能级修正，它需要减去
OUTCAR 中的 E-fermi 才是实验中测得的功函数的值。所幸的是 plot-workfunc.py 已经做了这个工作，用 locpot.dat 画出来的图就对应实验所测结果。</p>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>图源： <a href=http://exciting-code.org/nitrogen-dipole-correction>http://exciting-code.org/nitrogen-dipole-correction</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p><a href=https://www.vasp.at/wiki/index.php/DIPOL>https://www.vasp.at/wiki/index.php/DIPOL</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:3 role=doc-endnote>
<p>在 VASP 5.2.12 之前的版本中 <code>LVTOT</code> 输出的文件是静电势的贡献；但在 VASP 5.2.12 及之后的版本中，交换关联势的贡献也会被写入 <code>LOCPOT</code> 中， <code>LVHAR</code> 输出的部 分才是真正静电势的贡献，也就是我们想要的部分；&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:4 role=doc-endnote>
<p>CHGCAR 的格式请见 VASP 手册 <a href=https://www.vasp.at/wiki/index.php/CHGCAR>https://www.vasp.at/wiki/index.php/CHGCAR</a> ；&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:5 role=doc-endnote>
<p>完整脚本见 <a href=https://gist.github.com/Ionizing/1ac92f98e8b00a1cf6f16bd57694ff03>https://gist.github.com/Ionizing/1ac92f98e8b00a1cf6f16bd57694ff03</a> 。&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
<div class=post-copyright>
<p class=copyright-item>
<span class=item-title>文章作者</span>
<span class=item-content>Ionizing</span>
</p>
<p class=copyright-item>
<span class=item-title>上次更新</span>
<span class=item-content>
2021-04-23
</span>
</p>
<p class=copyright-item>
<span class=item-title>许可协议</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span>
</p>
</div>
<footer class=post-footer>
<div class=post-tags>
<a href=http://ionizing.page/tags/posts/>Posts</a>
<a href=http://ionizing.page/tags/vasp/>VASP</a>
<a href=http://ionizing.page/tags/python/>Python</a>
<a href=http://ionizing.page/tags/ase/>ASE</a>
<a href=http://ionizing.page/tags/dipolecorrection/>DipoleCorrection</a>
<a href=http://ionizing.page/tags/workfunction/>Workfunction</a>
</div>
<nav class=post-nav>
<a class=prev href=/post/issues-with-ips/>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417l277.93508-310.326815c11.338233-12.190647 11.035334-32.285311-.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"/></svg>
</i>
<span class="prev-text nav-default">镜像态的那些坑</span>
<span class="prev-text nav-mobile">上一篇</span>
</a>
<a class=next href=/post/vasp-convergence-test-scripts/>
<span class="next-text nav-default">VASP 收敛性测试的小脚本</span>
<span class="prev-text nav-mobile">下一篇</span>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697c-11.777231-11.500939-30.216186-10.304694-41.178865 2.712784z"/></svg>
</i>
</a>
</nav>
</footer>
</article>
</div>
</div>
</main>
<footer id=footer class=footer>
<div class=icon-links>
<a href=mailto:petersmith_9@outlook.com rel="me noopener" class=iconfont title=email><svg class="icon" viewBox="0 0 1451 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z"/></svg>
</a>
<a href=http://github.com/Ionizing rel="me noopener" class=iconfont title=github target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04C242.005334 929.664 211.968 830.08 211.968 830.08 188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg>
</a>
<a href=http://ionizing.page/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667v-199.04c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg>
</a>
</div>
<div class=copyright>
<span class=power-by>
Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span>
<span class=division>|</span>
<span class=theme-info>
Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a>
</span>
<span class=copyright-year>
&copy;
2021 -
2023
<span class=heart>
<i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg>
</i>
</span><span class=author>
Ionizing
</span></span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg>
</i>
</div>
</div>
<script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script>
<script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script>
<script type=text/javascript src=/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin=anonymous></script>
<script type=text/javascript>window.MathJax={showProcessingMessages:!1,messageStyle:'none'}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css integrity=sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5 crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js integrity=sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script>
<script type=text/javascript src=/js/load-photoswipe.js></script>
<script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script>
<script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script>
</body>
</html>